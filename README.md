# OS-labs-template-Tert
Тертычный Олег

# lab04
## Цель Программы
Проект предназначен для демонстрации динамической загрузки библиотек, реализации различных версий функций и их тестирования с использованием фреймворка Google Test. Основные функции, реализованные в библиотеке, включают:

Функция `translation(long number)`: Преобразует целое число в строку, представляющую это число в определённой системе счисления (например, двоичной или троичной).

Функция `Sort(int* array, int size)`: Сортирует массив целых чисел. Реализованы 2 алгоритма сортировки - пузырьковая и быстрая сортировки.

## Архитектура Работы Программы
Динамические Библиотеки (`libimpl1.so` и `libimpl2.so`):

`libimpl1.so:` Содержит реализацию функций `translation` и `Sort` с использованием двоичной системы счисления и пузырьковой сортировки.

`libimpl2.so:` Содержит реализацию тех же функций, но с использованием троичной системы счисления и быстрой сортировки.
Тестовая Программа (lab4_test):

Загружает динамические библиотеки во время выполнения с помощью `dlopen`.
Получает указатели на функции `translation` и `Sort` через `dlsym`.
Выполняет тесты для проверки корректности работы этих функций в различных реализациях.

## Тесты
Тестовая программа содержит четыре теста, каждый из которых проверяет определённую реализацию функций из динамических библиотек. Ниже приведено краткое описание каждого теста, его цели и механизма проверки.

1. <b>TranslationTest_Impl1.BinaryTranslation</b>  
Цель: Проверить корректность работы функции `translation` из библиотеки libimpl1.so при преобразовании числа в двоичную систему счисления.

* Описание:  
    - Загрузка Библиотеки: Загружает `libimpl1.so` с помощью `dlopen`.
    - Получение Функции: Получает указатель на функцию `translation` через `dlsym`.
    - Выполнение Функции: Вызывает `translation(10)`, ожидая получить строку "1010".

* Проверка Результата:  
Сравнивает полученную строку с ожидаемым значением "1010".

* Завершение:  
Закрывает библиотеку с помощью `dlclose`.
Почему Это Важно: Удостовериться, что реализация `translation` в `libimpl1.so` правильно преобразует число в двоичную систему, что является ключевой функциональностью библиотеки.

2. <b>SortTest_Impl1.BubbleSort</b>  
Цель: Проверить корректность работы функции `Sort` из библиотеки `libimpl1.so`, реализующей пузырьковую сортировку.

* Описание:  
    - Загрузка Библиотеки: Загружает `libimpl1.so` с помощью `dlopen`.
    - Получение Функции: Получает указатель на функцию `Sort` через `dlsym`.
    - Выполнение Функции: Вызывает `Sort(array, 5)`, где array = {5, 3, 2, 4, 1}.

* Проверка Результата:  
Сравнивает отсортированный массив с ожидаемым результатом {1, 2, 3, 4, 5}.

* Завершение:  
Закрывает библиотеку с помощью `dlclose`.
Почему Это Важно: Пузырьковая сортировка — простой, но неэффективный алгоритм. Тестирование её реализации позволяет проверить базовую функциональность сортировки в библиотеке.

3. <b>TranslationTest_Impl2.TernaryTranslation</b>  
Цель: Проверить корректность работы функции `translation` из библиотеки `libimpl2.so` при преобразовании числа в троичную систему счисления.

* Описание:  
    - Загрузка Библиотеки: Загружает `libimpl2.so` с помощью dlopen.
    - Получение Функции: Получает указатель на функцию `translation` через dlsym.
    - Выполнение Функции: Вызывает `translation(10)`, ожидая получить строку "101".

* Проверка Результата:  
Сравнивает полученную строку с ожидаемым значением "101".

* Завершение:  
Закрывает библиотеку с помощью `dlclose`.
Почему Это Важно: Проверка преобразования в троичную систему позволяет убедиться в корректной работе альтернативной реализации функции `translation` в другой системе счисления.

4. <b>SortTest_Impl2.QuickSort</b>  
Цель: Проверить корректность работы функции `Sort` из библиотеки `libimpl2.so`, реализующей быструю сортировку.

* Описание:   
    - Загрузка Библиотеки: Загружает `libimpl2.so` с помощью `dlopen`.
    - Получение Функции: Получает указатель на функцию `Sort` через `dlsym`.
    - Выполнение Функции: Вызывает `Sort(array, 5)`, где array = {5, 3, 2, 4, 1}.

* Проверка Результата:  
Сравнивает отсортированный массив с ожидаемым результатом {1, 2, 3, 4, 5}.

* Завершение:  
Закрывает библиотеку с помощью `dlclose`.
Почему Это Важно: Быстрая сортировка — эффективный алгоритм с лучшей производительностью по сравнению с пузырьковой сортировкой. Тестирование её реализации позволяет оценить эффективность и корректность более сложных алгоритмов сортировки в библиотеке.

## Описание работы функций:

### Функция `translation`

Функция `translation` принимает целое число и преобразует его в строку, представляющую это число в заданной системе счисления. В зависимости от реализации (двоичная или троичная), функция использует соответствующий алгоритм преобразования.

#### Реализация в `libimpl1.so` (Двоичная система)

```cpp
extern "C" char* translation(long number) {
    std::string binary = "";
    long n = number;
    if (n == 0) binary = "0";
    while (n > 0) {
        binary = std::to_string(n % 2) + binary;
        n /= 2;
    }
    char* result = new char[binary.length() + 1];
    std::strcpy(result, binary.c_str());
    return result;
}
```

#### Реализация в `libimpl2.so` (Троичная система)

```cpp
extern "C" char* translation(long number) {
    std::string ternary = "";
    long n = number;
    if (n == 0) ternary = "0";
    while (n > 0) {
        ternary = std::to_string(n % 3) + ternary;
        n /= 3;
    }
    char* result = new char[ternary.length() + 1];
    std::strcpy(result, ternary.c_str());
    return result;
}

```

### Функция `Sort`

Описание: Функция `Sort` принимает массив целых чисел и его размер, затем сортирует массив в порядке возрастания с использованием выбранного алгоритма сортировки.

#### Реализация в `libimpl1.so` (пузырьковая сортировка)

```cpp
extern "C" int* Sort(int* array, int size) {
    for(int i = 0; i < size-1; ++i) {
        for(int j = 0; j < size-i-1; ++j) {
            if(array[j] > array[j+1]) {
                // Обмен элементов
                int temp = array[j];
                array[j] = array[j+1];
                array[j+1] = temp;
            }
        }
    }
    return array;
}

```

#### Реализация в `libimpl2.so` (Сортировка Хоара)

```cpp
extern "C" int* Sort(int* array, int size) {
    quickSort(array, 0, size - 1);
    return array;
}

int partition(int* array, int low, int high) {
    int pivot = array[high]; // Опорный элемент
    int i = (low - 1);
    for(int j = low; j <= high - 1; ++j) {
        if(array[j] < pivot) {
            ++i;
            // Обмен элементов
            int temp = array[i];
            array[i] = array[j];
            array[j] = temp;
        }
    }
    // Обмен опорного элемента с элементом после последнего меньшего
    int temp = array[i + 1];
    array[i + 1] = array[high];
    array[high] = temp;
    return (i + 1);
}

void quickSort(int* array, int low, int high) {
    if(low < high) {
        int pi = partition(array, low, high);
        quickSort(array, low, pi - 1);
        quickSort(array, pi + 1, high);
    }
}
```
